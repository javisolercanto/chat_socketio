<!DOCTYPE HTML>

<html>
   <head>
    <script src="socket.io.js"></script>
      <script type = "text/javascript">
         let nickname = "Mr Anderson";
         let DEBUG = true;
         function WebSocketChat() {              


            if ("WebSocket" in window) {
               if (DEBUG) console.log("WebSocket is supported by your Browser!");
               const socket = io();

               let sendBtn = document.getElementById('send');
               sendBtn.onclick = function(){
                let inputMessage = document.getElementById('message');
                socket.emit('newMessage',`${nickname}: ${inputMessage.value}`)
               }
               
              
               
               socket.on('connect', () => {
                  socket.emit('hello',`${nickname} connected to the chat`);
               });
               /*ws.onopen = function() {                  
                  // Web Socket is connected, send data using send()
                  ws.send(`${nickname} connected to the chat`);
                  if (DEBUG) console.log(`${nickname} connected to the chat`)                  
               };*/
				
               /*ws.onmessage = function (evt) { 
                  var received_msg = evt.data;
                  let messagesDiv=document.getElementById("chatMessages");
                  let messageEl = document.createElement('span');
                  messageEl.innerHTML = received_msg;

                  messagesDiv.insertBefore(messageEl,messagesDiv.firstChild);
                  if (DEBUG) console.log("Message is received...");
               };*/
				
               /*ws.onclose = function() { 
                  
                  // websocket is closed.
                  alert("Connection is closed..."); 
               };*/
            } else {
              
               // The browser doesn't support WebSocket
               alert("WebSocket NOT supported by your Browser!");
            }
         }
         
      </script>
		
   </head>
   
   <body>
     <div id="chatMessages"> </div>
     <input type="text" id="message" name="message" /><button id="send">SEND</button>

      <script>
          WebSocketChat();
      </script>
   </body>
</html>